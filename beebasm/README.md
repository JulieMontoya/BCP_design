# Files for the new BeebAsm build system #

BCP is now a BeebAsm project, although it is still intended to maintain a native BBC-compatible build process as a secondary objective.  (Otherwise, it's not
really a BBC project at all, but a PC project with a specialised toolchain and runtime.)

## To Build the Latest Version ##
For the desperately impatient:
```
$ nano bcp_main.6502 #    comment where indicated
$ beebasm -i bcp_main.6502 -di bcp_latest_base.ssd -do bcp_latest.ssd -v > bcp_main.log
```
Then mount and boot `bcp_latest.ssd` in a BBC Emulator, or transfer the disc image to a real floppy disc and boot in a real BBC Micro.


Code sits in memory roughly thus:

Address | Contents
--------|-------------------
&0A00   | Main Workspace
&1900   | BASIC wrapper
.       | Design database
.       | Design Application
.       | Graphics Library
.       | Database Library
.       | Maths Library
&5800   | Screen memory



## bcp_main.6502 ##
This assembler file `INCLUDE`s each section of code, and `SAVE`s the assembled binary to a disc image.  

## WKS04SC.6502 ##
Variable definitions for zero page and main workspace locations and OS call entry points.

## MTH13SC.6502 ##
The mathematics library.  This sits just before the MODE 4 / MODE 5 screen memory.  As of version 11, this includes  (what it is to be hoped should be)  a fairly static jump table, with `JMP`s into the code from entry points that will not change from version to version.  This should avoid having to remake the variable dump so often.

## DBM58SC.6502 ##
The database manager.  As of version 57, this sits after the graphics subroutines; the maths and database code are sufficient in themselves to run the utilities disc programs.  This includes subroutines for parsing input, packing and retrieving parts, pins and vertices of routed tracks, and for `*LOAD`ing and `*SAVE`ing the database contents.

## GFX51SC.6502 ##
The graphics library.  This provides subroutines used by the design application to draw component pads and silkscreen outlines and routed tracks on the screen.  As of version 50  (if not sooner, at least unofficially),  this is not needed by the programs on the utilities disc.
**2020-01-26** Fixed an issue which was causing pads sometimes to be drawn wrongly; the location `tpc` was being overwritten by the scaling of the length and width.  The value that was being stored here is now pushed to the stack instead.

## DES18SC.6502 ##
The design application.  Accepts commands and despatches to the appropriate subroutine to implement actions.  

## bcp_latest_base.ssd ##
This disc image file contains the BASIC loader, but none of the files generated by BeebAsm, so it can have the output files added directly to it.

```
$ nano bcp_main.6502 #    comment where indicated
$ beebasm -i bcp_main.6502 -v > bcp_main.log
$ nano bcp_main.6502 #    uncomment where indicated
$ gather_vars -m L.MINVARS -l bcp_main.log -O bcp_main.vars bcp_main.6502
$ beebasm -i bcp_main.6502 -di bbcpcb110_nocode.ssd -do bbcpcb110.ssd
```

## photoplot_main.6502 ##
This file `INCLUDE`s each of the files necessary to build the photoplot program.  This is currently in three parts; the plotting library, a font for generating text on the photoplotter and the menu code.  (It probably will be split up further in future.)
