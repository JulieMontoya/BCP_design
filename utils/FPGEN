    1REM..SET P0% AND Q0% BEFORE..
    2REM..CALLING PROCdump_fp()..
   10MODE4:HIMEM=&5000
   20VDU28,0,31,39,8
   30K%=1
 2000DIMdata% 2048
 2010E%=data%MOD256:IFE%data%=data%+256-E%
 2020IFK%data%=&5800
 2030DIMdc%(15)
 2040FORI%=0TO15:dc%(I%)=0:NEXT
 2050ONERRORGOTO6800
 2060PRINT"Data starts at ";~data%
 2070nfp%=0
 2080pnl%=0
 2090ssl%=0
 2100O%=data%+3
 2110O0%=O%
 2120PRINT'"**************  PASS ONE  **************"
 2130REPEAT
 2140READN$
 2150READC%,L%,B%,R%,T%,X%,Y%,Z%,S%,N%
 2160N$=N$+"       "
 2170PRINTLEFT$(N$,7);
 2180IFC%<10PRINT" ";
 2190PRINT;C%;
 2200PRINT" ";
 2210FORJ%=0TO6
 2220O%?J%=ASCMID$(N$,J%+1,1)
 2230NEXTJ%
 2240O%?7=C%
 2250PROCpackXY(O%+8,L%,B%)
 2260PROCpackXY(O%+11,R%,T%)
 2270PROCpackXY(O%+14,X%,Y%)
 2280O%?17=(Z%AND3)*64ORS%AND15
 2290REMPRINT"Silkscreen offset is &";~ssl%
 2300PROCpoke(O%+18,ssl%)
 2310O%?20=N%
 2320REMPRINT"Pins offset is &";~pnl%
 2330PROCpoke(O%+21,pnl%)
 2340FORJ%=1TOC%
 2350READX%,Y%,T%,B%,H%
 2360dc%(T%)=dc%(T%)+1
 2370dc%(B%)=dc%(B%)+1
 2380NEXTJ%
 2390FORJ%=1TON%
 2400READM$,X%,Y%
 2410NEXTJ%
 2420O%=O%+23
 2430nfp%=nfp%+1
 2440pnl%=pnl%+5*C%
 2450ssl%=ssl%+3*N%
 2460UNTILFALSE
 3000RESTORE
 3010ONERRORGOTO6850
 3020fpl%=3+23*nfp%
 3030PRINT
 3040REMPRINT"Data starts &";~data%
 3050PRINT"Number of footprints:";nfp%;" Length &";~fpl%
 3060P%=FNnxtpg(data%+fpl%)
 3070P0%=P%
 3080PRINT"Pins start &";~P%;" length & ";~pnl%
 3090Q%=FNnxtpg(P%+pnl%)
 3100Q0%=Q%
 3110PRINT"S'scrn starts at &";~Q%;" length &";~ssl%
 3120end%=FNnxtpg(Q%+ssl%)
 3130PRINT"Data finishes &";~end%
 3140?data%=nfp%
 3150data%?1=16*((Q%-P%)DIV256)+(end%-Q%)DIV256
 3160data%?2=&11
 3170PRINT'"**************  PASS TWO  **************"
 3180REPEAT
 3190READN$
 3200READC%,L%,B%,R%,T%,X%,Y%,Z%,S%,N%
 3210N$=N$+"       "
 3220PRINTLEFT$(N$,7);
 3230IFC%<10PRINT" ";
 3240PRINT;C%;
 3250PRINT" ";
 3260FORJ%=1TOC%
 3270READX%,Y%,T%,B%,H%
 3280PROCpackXY(P%,X%,Y%)
 3290P%?3=((T%AND&F)*16)OR(B%AND&F)
 3300P%?4=H%
 3310REMPRINT"Pin ";J%;" P%=&";~P%
 3320P%=P%+5
 3330NEXTJ%
 3340FORJ%=1TON%
 3350READM$,X%,Y%
 3360IFM$="M"?Q%=X%DIV2AND&7F:Q%?1=Y%DIV2AND&7F
 3370IFM$="D"?Q%=X%DIV2AND&7F:Q%?1=Y%DIV2AND&7F OR&80
 3380IFM$="T"?Q%=X%DIV2AND&7F OR&80:Q%?1=Y%DIV2AND&7F
 3390IFM$="C"?Q%=X%DIV2AND&7F OR&80:Q%?1=Y%DIV2AND&7F OR&80
 3400Q%?2=((X%AND&F00)DIV256)OR((Y%AND&F00)DIV16)
 3410Q%=Q%+3
 3420NEXTJ%
 3430UNTILFALSE
 3440END
 4000PRINT'"**************  ALL DONE  **************"
 4010PRINT"Pad shapes used:"
 4020FORI%=1TO15
 4030IFdc%(I%)PRINTRIGHT$("    "+STR$I%,4);" ";
 4040NEXT:PRINT
 4100PRINT'"Copy this line to save data:"
 4110PRINT" *SAVE D.FTPRNT ";~data%;" +";~end%-data%
 4120END
 4990END
 5000CLS
 5010A%=0
 5020Z$="MOVE DRAW TRI  CLOSE"
 5030fp%=data%+3+23*A%
 5040pd%=data%+fpl%+FNpeek(fp%+21)
 5050ss%=data%+fpl%+pnl%+FNpeek(fp%+18)
 5060pins%=?(fp%+7)AND127
 5070vrtx%=?(fp%+20)
 5080C$=""
 5090FORJ%=0TO6
 5100C%=?(fp%+J%):IFC%>32ANDC%<127 C$=C$+CHR$C%
 5110NEXTJ%
 5120PRINT"FP index :";A%;"  '"C$"'"
 5130PRINT"FP base  =&";~fp%
 5140PRINT"Pins base=&";~pd%;"  Pins :";pins%
 5150PRINT"SS base  =&";~ss%;"  Vrtx :";vrtx%
 5160PRINT"Pins base=&";~FNpads(A%);"  Pins :";FNpins(A%)
 5170PRINT"SS base  =&";~FNsilk(A%);"  Vrtx :";FNslkL(A%)
 5590END
 5600DEFPROCdump_fp(A%)
 5610Z$="MOVE DRAW TRI  CLOSE"
 5620fp%=O0%+23*A%
 5630pd%=P0%+FNpeek(fp%+21)
 5640ss%=Q0%+FNpeek(fp%+18)
 5650pins%=?(fp%+7)AND127
 5660vrtx%=?(fp%+20)
 5670C$=""
 5680FORJ%=0TO6
 5690C%=?(fp%+J%):IFC%>32ANDC%<127 C$=C$+CHR$C%
 5700NEXTJ%
 5710REMPRINT"No of pins:";pins%
 5720bl%=FNunpackX(fp%+8):bb%=FNunpackY(fp%+8)
 5730REMPRINT"Boundary L:";bl%
 5740REMPRINT"Boundary B:";bb%
 5750br%=FNunpackX(fp%+11):bt%=FNunpackY(fp%+11)
 5760REMPRINT"Boundary R:";br%
 5770REMPRINT"Boundary T:";bt%
 5780lx%=FNunpackX(fp%+14):ly%=FNunpackY(fp%+14)
 5790REMPRINT"Legend   X:";lx%
 5800REMPRINT"Legend   Y:";ly%
 5810la%=((fp%?17)AND192)DIV64:ls%=(fp%?17)AND15
 5820REMPRINT"Legend ang:";la%
 5830REMPRINT"Legend  sz:";ls%
 5840REMPRINT"Vertices  :";vrtx%
 5850REM
 5860IFL%PRINT;L%;:L%=L%+10
 5870PRINT"DATA""";C$;""",";pins%;",";bl%;",";bb%;",";br%;",";bt%;",";
 5880PRINT;lx%;",";ly%;",";la%;","ls%;",";vrtx%
 5890REM
 5900REM
 5910REM
 5920FORJ%=0TOpins%-1
 5930M%=pd%+5*J%
 5940X1%=?M%:Y1%=M%?1:H%=M%?2:S%=M%?3:D%=M%?4
 5950X%=256*(H%AND&0F)+X1%:IFX%>2048X%=X%-4096
 5960Y%=16*(H%AND&F0)+Y1%:IFY%>2048Y%=Y%-4096
 5970S1%=(S%DIV16):S2%=S%MOD16
 5980REMPRINT;J%+1;" ";FNfw(X%,5);" ";FNfw(Y%,5);" ";FNfw(S1%,2);" ";FNfw(S2%,2);" ";FNfw(D%,3)
 5990IFL%PRINT;L%;:L%=L%+10
 6000PRINT"DATA";X%;",";Y%;",";S1%;",";S2%;",";D%
 6010NEXTJ%
 6020REM
 6030FORJ%=0TOvrtx%-1
 6040M%=ss%+3*J%
 6050X1%=?M%:Y1%=M%?1:H%=M%?2
 6060X%=256*(H%AND&0F)+2*(X1%AND&7F):IFX%>2047X%=X%-4096
 6070Y%=16*(H%AND&F0)+2*(Y1%AND&7F):IFY%>2047Y%=Y%-4096
 6080K%=0:IFX1%AND&80K%=K%OR2
 6090IFY1%AND&80K%=K%OR1
 6100REMPRINT;J%+1;" ";MID$(Z$,K%*5+1,5);" ";FNfw(X%,5);" ";FNfw(Y%,5)
 6110IFL%PRINT;L%;:L%=L%+10
 6120PRINT"DATA""";MID$(Z$,K%*5+1,1);""",";X%;",";Y%
 6130NEXTJ%
 6140ENDPROC
 6150END
 6800ONERROROFF
 6810REPORT:PRINT" at line ";ERL;:PRINT" (";ERR;")"
 6820IFERR=42GOTO3000
 6830END
 6850ONERROROFF
 6860REPORT:PRINT" at line ";ERL;:PRINT" (";ERR;")"
 6870IFERR=42GOTO4000
 6880END
 6990END
 7000DEFFNpeek(P%)
 7010Q%=!P%AND&FFFF:IFQ%>32767Q%=Q%OR&FFFF0000
 7020=Q%
 7030DEFPROCpoke(P%,Q%)
 7040!P%=!P%AND&FFFF0000ORQ%AND&FFFF
 7050ENDPROC
 7060DEFPROCpackXY(W%,X%,Y%)
 7070?W%=X%AND&FF
 7080W%?1=Y%AND&FF
 7090W%?2=(X%AND&F00)DIV256OR(Y%AND&F00)DIV16
 7100ENDPROC
 7110DEFFNunpackX(W%)
 7120X%=?W%+256*((W%?2)AND&F)
 7130IFX%AND&800X%=X%OR&FFFFF000
 7140=X%
 7150DEFFNunpackY(W%)
 7160Y%=W%?1+16*((W%?2)AND&F0)
 7170IFY%AND&800Y%=Y%OR&FFFFF000
 7180=Y%
 7190DEFFNpins(N%)=?(data%+3+23*N%+7)
 7200DEFFNbdyL(N%)=FNunpackX(data%+3+23*N%+8)
 7210DEFFNbdyB(N%)=FNunpackY(data%+3+23*N%+8)
 7220DEFFNbdyR(N%)=FNunpackX(data%+3+23*N%+11)
 7230DEFFNbdyT(N%)=FNunpackY(data%+3+23*N%+11)
 7240DEFFNlgdX(N%)=FNunpackX(data%+3+23*N%+14)
 7250DEFFNlgdY(N%)=FNunpackY(data%+3+23*N%+14)
 7260DEFFNlgdA(N%)=(?(data%+3+23*N%+17))DIV&40
 7270DEFFNlgdS(N%)=(?(data%+3+23*N%+17))AND&F
 7280DEFFNsilk(N%)=FNpeek(data%+3+23*N%+18)+data%+fpl%+pnl%
 7290DEFFNslkL(N%)=?(data%+3+23*N%+20)
 7300DEFFNpads(N%)=FNpeek(data%+3+23*N%+21)+data%+fpl%
 7310DEFFNpadX(N%,H%)
 7320M%=FNpads(N%)
 7330REMPRINT"M%=&";~M%
 7340=FNunpackX(M%+5*H%)
 7350DEFFNpadY(N%,H%)
 7360M%=FNpads(N%)
 7370REMPRINT"M%=&";~M%
 7380=FNunpackY(M%+5*H%)
 7390DEFFNfw(N%,L%)
 7400=RIGHT$(STRING$(L%," ")+STR$N%,L%)
 7410DEFFNnxtpg(A%)
 7420LOCALB%
 7430B%=A%MOD256
 7440IFB%A%=A%+&100-B%
 7450=A%
19900REM..DATA IS AS FOLLOWS..
19910REM.
19920REM..FOOTPRINT NAME,NO. OF PINS..
19930REM..BOUNDARY L,B,R,T..
19940REM..LEGEND X,Y,ANGLE,SIZE..
19950REM..NO. OF VERTICES..
19960REM
19970REM..FOR EACH PIN:..
19980REM..PIN X,Y,DCODE TOP,UND,DRILL..
19990REM
20000REM..FOR EACH VERTEX:..
20010REM..Move/Draw/Tri/Close,X,Y..
20030DATA"DIP8",8,-215,-190,215,190,-150,290,0,1,8
20040DATA-150,150,13,1,8
20050DATA-150,50,13,1,8
20060DATA-150,-50,13,1,8
20070DATA-150,-150,13,1,8
20080DATA150,-150,13,1,8
20090DATA150,-50,13,1,8
20100DATA150,50,13,1,8
20110DATA150,150,13,1,8
20120DATA"M",20,170
20130DATA"D",20,190
20140DATA"D",70,190
20150DATA"D",70,-190
20160DATA"D",-70,-190
20170DATA"D",-70,190
20180DATA"D",-20,190
20190DATA"C",-20,170
20210DATA"RQ4X1",2,-265,-40,265,40,-100,140,0,1,2
20220DATA-200,0,1,1,8
20230DATA200,0,1,1,8
20240DATA"M",100,40
20250DATA"C",-100,-40
20270DATA"RQ5X1",2,-315,-40,315,40,-100,140,0,1,6
20280DATA-250,0,1,1,8
20290DATA250,0,1,1,8
20300DATA"M",-100,40
20310DATA"C",100,-40
20320DATA"M",100,0
20330DATA"D",150,0
20340DATA"M",-150,0
20350DATA"D",-100,0
20370DATA"RQ6X1",2,-365,-40,365,40,-100,140,0,1,6
20380DATA-300,0,1,1,8
20390DATA300,0,1,1,8
20400DATA"M",-100,40
20410DATA"C",100,-40
20420DATA"M",100,0
20430DATA"D",200,0
20440DATA"M",-200,0
20450DATA"D",-100,0
20470DATA"CE5X1",2,-100,-100,100,100,-200,200,0,1,10
20480DATA0,50,5,5,8
20490DATA0,-50,5,5,8
20500DATA"M",-54,100
20510DATA"D",-100,54
20520DATA"D",-100,-54
20530DATA"D",-54,-100
20540DATA"T",-54,-54
20550DATA"M",54,100
20560DATA"D",100,54
20570DATA"D",100,-54
20580DATA"D",54,-100
20590DATA"T",54,-54
20610DATA"CP2X1",2,-150,-50,150,50,-150,150,0,1,2
20620DATA-100,0,5,5,10
20630DATA100,0,5,5,10
20640DATA"M",-150,-50
20650DATA"C",150,50
20670DATA"D1A4X1",2,-265,-40,265,40,-100,140,0,1,6
20680DATA-200,0,1,1,10
20690DATA200,0,1,1,10
20700DATA"M",100,40
20710DATA"D",100,-40
20720DATA"T",70,40
20730DATA"T",70,-40
20740DATA"D",-100,-40
20750DATA"C",-100,40
20770DATA"HM2X1",2,-50,-100,50,100,200,50,3,1,2
20780DATA0,50,5,5,10
20790DATA0,-50,5,5,10
20800DATA"M",-50,-100
20810DATA"C",50,100
20830DATA"TO92CBE",3,-50,-150,100,150,0,0,0,1,6
20840DATA0,100,5,5,8
20850DATA0,0,5,5,8
20860DATA0,-100,5,5,8
20870DATA"M",-50,150
20880DATA"D",50,150
20890DATA"D",100,100
20900DATA"D",100,-100
20910DATA"D",50,-150
20920DATA"C",-50,-150
20940DATA"SOT23W",3,-58,-70,58,70,0,0,0,1,8
20950DATA0,43,7,0,0
20960DATA-37,-44,7,0,0
20970DATA37,-44,7,0,0
20980DATA"M",-24,70
20990DATA"D",-58,70
21000DATA"D",-58,-10
21010DATA"M",-10,-70
21020DATA"D",10,-70
21030DATA"M",58,-10
21040DATA"D",58,70
21050DATA"D",24,70
21070DATA"R3216W",2,-80,-40,80,40,0,0,0,1,2
21080DATA-57,0,8,0,0
21090DATA57,0,8,0,0
21100DATA"M",-80,-40
21110DATA"C",80,40
21130DATA"HM3X1",3,-50,-150,50,150,0,0,0,1,2
21140DATA0,100,5,5,10
21150DATA0,0,5,5,10
21160DATA0,-100,5,5,10
21170DATA"M",-50,-150
21180DATA"C",50,150
21200DATA"DIP14",14,-215,-340,215,340,0,0,0,1,8
21210DATA-150,300,13,1,8
21220DATA-150,200,1,1,8
21230DATA-150,100,1,1,8
21240DATA-150,0,1,1,8
21250DATA-150,-100,1,1,8
21260DATA-150,-200,1,1,8
21270DATA-150,-300,1,1,8
21280DATA150,-300,1,1,8
21290DATA150,-200,1,1,8
21300DATA150,-100,1,1,8
21310DATA150,0,1,1,8
21320DATA150,100,1,1,8
21330DATA150,200,1,1,8
21340DATA150,300,1,1,8
21350DATA"M",20,320
21360DATA"D",20,340
21370DATA"D",70,340
21380DATA"D",70,-340
21390DATA"D",-70,-340
21400DATA"D",-70,340
21410DATA"D",-20,340
21420DATA"C",-20,320
21440DATA"B9A105",9,-511,-486,511,486,0,0,0,1,10
21450DATA242,-334,4,4,0
21460DATA393,-127,4,4,0
21470DATA393,127,4,4,0
21480DATA242,334,4,4,0
21490DATA0,413,4,4,0
21500DATA-242,334,4,4,0
21510DATA-393,127,4,4,0
21520DATA-393,-127,4,4,0
21530DATA-242,-334,4,4,0
21540DATA"M",510,0
21550DATA"D",414,300
21560DATA"D",158,486
21570DATA"D",-158,486
21580DATA"D",-414,300
21590DATA"D",-510,0
21600DATA"D",-414,-300
21610DATA"D",-158,-486
21620DATA"D",158,-486
21630DATA"C",414,-300
